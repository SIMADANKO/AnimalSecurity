**宠物保险系统详细设计书**

**文档版本**：1.0
**编写人**：盧 嘉俊
**日期**：2024-12-06

------

## **目录**

1. 引言
2. 系统概述
3. 模块设计
   3.1 用户管理模块
   3.2 宠物信息管理模块
   3.3 保险产品管理模块
   3.4 保险购买模块
   3.5 理赔管理模块
4. 数据库设计
5. 接口设计
6. 异常处理
7. 安全设计
8. 附录

------

## **1. 引言**

### **1.1 目标**

本详细设计书旨在为宠物保险系统的开发提供具体的技术实现方案，包括功能设计、数据库结构、接口定义和安全策略。

### **1.2 范围**

系统涵盖用户注册、宠物信息管理、保险产品管理、保险购买和理赔等主要功能。

### **1.3 参考文档**

- 《宠物保险系统需求规格说明书》
- 《系统架构设计文档》

------

## **2. 系统概述**

### **2.1 系统架构**

系统采用B/S架构，分为前端、后端和数据库三部分：

- **前端**：基于Vue框架构建。
- **后端**：使用Spring Boot框架。
- **数据库**：MySQL数据库 。

### **2.2 功能概览**

- **用户管理**：用户注册、登录、个人信息修改。
- **宠物信息管理**：宠物添加、修改、查询。
- **保险产品管理**：查看和管理保险产品。
- **保险购买**：保险购买流程和支付功能。

------

## **3. 模块设计**

### **3.1 用户管理模块**

#### **功能描述**

- 实现用户注册、登录、密码找回及个人信息修改。

​      *流程设计*

1. 用户填写注册信息。
2. 系统验证数据合法性，写入数据库。
3. 登录时验证用户输入的用户名和密码是否匹配。

### **3.2 宠物信息管理模块**

#### **功能描述**

- 用户可添加、查看、修改和删除宠物信息。

   *流程设计*

### **3.3 保险产品管理模块**

#### **功能描述**

+ 管理员管理保险产品信息，用户可查看产品详情。

   *流程设计*

------

### **3.4 保险购买模块**

#### **功能描述**

+ 用户选择保险产品并完成支付。

*流程设计*

1. 用户选择保险产品并提交购买请求。
2. 系统生成订单并调用支付接口。
3. 支付成功后更新数据库状态。

------

### **3.5 理赔管理模块**

#### **功能描述**

+ 用户提交理赔申请，管理员审核并处理。

*流程设计*

1. 用户提交理赔申请，附上证明材料。

2. 管理员审核申请并更新状态（通过/拒绝）。

------

## **4. 数据库设计**

- **E-R图**: 系统中包含以下主要实体：`users`、`pets`、`vendors`、`orders`、`policy`。

- 关系如下：
  - 用户可以拥有多只宠物。
  - 用户可以购买多个保险产品。
  - 每个保险产品可以绑定多个理赔记录。

**用户表**(users)

| 字段名   | 类型         | 约束       | 说明         |
| -------- | ------------ | ---------- | ------------ |
| id       | INT          | 主键，自增 | 用户ID       |
| username | VARCHAR(50)  | 唯一，非空 | 用户名       |
| password | VARCHAR(255) | 非空       | 密码（加密） |
| email    | VARCHAR(100) | 唯一，非空 | 邮箱         |



**宠物表**(pets)

| 字段名   | 类型                  | 约束       | 说明             |
| -------- | --------------------- | ---------- | ---------------- |
| id       | INT                   | 主键，自增 | 宠物ID           |
| user_id  | INT                   | 外键，非空 | 所属用户ID       |
| pet_name | VARCHAR(50)           | 非空       | 宠物名称         |
| species  | VARCHAR(50)           | 非空       | 宠物种类（如狗） |
| breed    | VARCHAR(50)           |            | 宠物品种         |
| age      | INT                   |            | 宠物年龄         |
| gender   | ENUM('Male','Female') |            | 宠物性别         |



**订单表**(orders)

| 字段名       | 类型                                           | 约束       | 说明                   |
| ------------ | ---------------------------------------------- | ---------- | ---------------------- |
| order_id     | INT                                            | 主键，自增 | 订单ID                 |
| pet_id       | INT                                            | 外键，非空 | 宠物ID，外键关联宠物表 |
| policy_id    | INT                                            | 外键，非空 | 保险产品ID             |
| order_status | ENUM('Pending','Active','Expired','Cancelled') | 非空       | 订单状态               |
| total_price  | DECIMAL(10,2)                                  | 非空       | 订单总金额             |
| start_date   | TIMESTAMP                                      | 默认       | 保险开始日期           |
| end_date     | TIMESTAMP                                      | 默认       | 保险结束日期           |
| create_time  | TIMESTAMP                                      | 默认       | 订单创建时间           |
| update_time  | TIMESTAMP                                      | 默认       | 订单更新时间           |



**商家表**(vendors)

| 字段名         | 类型         | 约束       | 说明         |
| -------------- | ------------ | ---------- | ------------ |
| vendors_id     | INT          | 主键，自增 | 商家ID       |
| vendors_name   | VARCHAR(100) | 非空       | 商家名       |
| contract_email | VARCHAR(100) | 非空       | 商家邮箱     |
| contract_phone | VARCHAR(25)  | 非空       | 商家联系电话 |
| address        | VARCHAR(255) | 非空       | 商家地址     |

**保险产品表**（policy）

| 字段名      | 类型          | 约束       | 说明               |
| ----------- | ------------- | ---------- | ------------------ |
| policy_id   | int           | 主键、自增 | 保险产品ID（主键） |
| policy_name | varchar(100)  | 非空       | 保险产品名称       |
| description | text          |            | 保险产品描述       |
| premium     | decimal(10,2) | 非空       | 保费               |
| coverage    | decimal(10,2) | 非空       | 保险覆盖金额       |
| term_months | int           | 否         | 保险期限（月）     |



## **5. 接口设计**

- 添加宠物

  - **URL**: `/api/pets/add`

  - **方法**: POST

  - 请求示例

    ```
    json复制代码{
      "name": "Buddy",
      "type": "Dog",
      "age": 3,
      "breed": "Golden Retriever"
    }
    ```

  - 响应示例

    ```
    json复制代码{
      "status": "success",
      "message": "Pet added successfully"
    }
    ```

------

- 用户注册

  - **URL**: `/api/users/register`

  - **方法**: POST

  - 请求示例

    ```
    json复制代码{
      "username": "john_doe",
      "password": "secure_password",
      "email": "john@example.com"
    }
    ```

  - 响应示例

    ```
    json复制代码{
      "status": "success",
      "message": "User registered successfully"
    }
    ```

------

## **6. 异常处理**

- **输入验证失败**：返回400状态码和错误信息。
- **用户未登录**：返回401状态码和提示。
- **数据库连接失败**：记录日志并返回500状态码。

------

## **7. 安全设计**

- **用户认证**：采用JWT（JSON Web Token）。
- **数据加密**：使用AES加密用户敏感信息（如密码）。
- **防护措施**：CSRF防护、SQL注入检测。

------

## **8. 附录**

- 术语表
  - **保险产品**：用户可选择的宠物保险方案。
  - **理赔申请**：用户提交的保险赔偿请求。